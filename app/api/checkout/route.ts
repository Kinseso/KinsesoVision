import Stripe from 'stripe'; export const dynamic='force-dynamic'; const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!,{apiVersion:'2024-06-20'});
export async function POST(req:Request){ const body = await req.json(); const session = await stripe.checkout.sessions.create({ mode:'payment', line_items:[{price_data:{currency:body.currency||'gbp',product_data:{name:body.title},unit_amount:body.amount_cents},quantity:1}], success_url:`${process.env.SITE_URL}/marketplace?success=1`, cancel_url:`${process.env.SITE_URL}/marketplace?canceled=1` }); return new Response(JSON.stringify({url:session.url}),{status:200}); }
